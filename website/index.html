<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- PAGE settings -->
  <link rel="icon" href="https://templates.pingendo.com/assets/Pingendo_favicon.ico">
  <title>XX병원 환자관리 시스템</title>
  <meta name="description" content="Wireframe design of a pricing table by Pingendo">
  <meta name="keywords" content="Pingendo bootstrap example template wireframe pricing table">
  <meta name="author" content="Pingendo">
  <!-- CSS dependencies -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    type="text/css">
  <link rel="stylesheet" href="wireframe.css">
</head>

<body class="bg-light">
  <div class="d-flex flex-column flex-md-row align-items-center p-3 mb-3 box-shadow border-bottom">
    <h5 class="my-0 mr-md-auto font-weight-normal">XX병원 환자관리</h5>
    <nav class="my-2 my-md-0 mr-md-3">
      <a class="p-2 text-dark" href="#">병원관리</a>
      <a class="p-2 text-dark" href="#">환자관리</a>
      <a class="p-2 text-dark" href="#">재고관리</a>
    </nav>
    <a class="btn btn-outline-info" href="#" contenteditable="true">로그아웃</a>
  </div>
  <div class="pt-5 text-center">
    <div class="container">
      <div class="row">
        <div class="col-md-9 mx-auto">
          <h1 class="display-4">환자 관리 시스템</h1>
          <p class="lead">현재 수액 투여&nbsp;환자의 목록입니다. 더블클릭하면 히스토리를 볼 수 있습니다.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="text-center">
    <div class="container">
      <div class="row pt-4">
        <div class="col-md-4">
          <div class="card mb-4 box-shadow">
            <div class="card-header">
              <h4 class="my-0 font-weight-normal">203호<br></h4>
            </div>
            <div class="card-body">
              <h1>조강림</h1>
              <ul class="list-unstyled mt-3 mb-4">
                <li>비타민</li>
                <li>NaCl</li>
                <li>포도당</li>
                <li>D5W</li>
              </ul>
              <button type="button" id="p0" class="btn btn-lg btn-block btn-outline-info">수액 투여중</button>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card mb-4 box-shadow">
            <div class="card-header">
              <h4 class="my-0 font-weight-normal">207호<br></h4>
            </div>
            <div class="card-body">
              <h1>박지만</h1>
              <ul class="list-unstyled mt-3 mb-4">
                <li>아세트아미노펜<br></li>
                <li>포도당</li>
                <li>비타민<br></li>
                <li>NaCl<br></li>
              </ul>
              <button type="button" id="p1" class="btn btn-lg btn-block btn-primary">수액 투여완료 / 조치 요망</button>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card mb-4 box-shadow">
            <div class="card-header">
              <h4 class="my-0 font-weight-normal">201호</h4>
            </div>
            <div class="card-body">
              <h1>김재우</h1>
              <ul class="list-unstyled mt-3 mb-4">
                <li>NaCl<br></li>
                <li>포도당</li>
                <li>아세트아미노펜</li>
                <li>감기약</li>
              </ul>
              <button type="button" id="p2" class="btn btn-lg btn-block btn-primary">수액 투여완료 / 조치 완료</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="py-5">
    <div class="container">
      <div class="row pt-5 border-top">
        <div class="col-12 col-md"> <i class="fa fa-lg fa-bullseye d-block mb-2"></i> <small
            class="d-block mb-3 text-muted">© 2017-2018</small><small class="d-block mb-3 text-muted">©
            2017-2018</small> </div>
        <div class="col-6 col-md">
          <h5><b>Features</b></h5>
          <ul class="list-unstyled">
            <li>
              <a class="text-muted" href="#">Cool stuff</a>
            </li>
            <li>
              <a class="text-muted" href="#">Random feature</a>
            </li>
            <li>
              <a class="text-muted" href="#">Team feature</a>
            </li>
            <li>
              <a class="text-muted" href="#">Stuff for developers</a>
            </li>
            <li>
              <a class="text-muted" href="#">Another one</a>
            </li>
            <li>
              <a class="text-muted" href="#">Last time</a>
            </li>
          </ul>
        </div>
        <div class="col-6 col-md">
          <h5><b>Resources</b></h5>
          <ul class="list-unstyled">
            <li>
              <a class="text-muted" href="#">Resource</a>
            </li>
            <li>
              <a class="text-muted" href="#">Resource name</a>
            </li>
            <li>
              <a class="text-muted" href="#">Another resource</a>
            </li>
            <li>
              <a class="text-muted" href="#">Final resource</a>
            </li>
          </ul>
        </div>
        <div class="col-6 col-md">
          <h5><b>About</b></h5>
          <ul class="list-unstyled">
            <li>
              <a class="text-muted" href="#">Team</a>
            </li>
            <li>
              <a class="text-muted" href="#">Locations</a>
            </li>
            <li>
              <a class="text-muted" href="#">Privacy</a>
            </li>
            <li>
              <a class="text-muted" href="#">Terms</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div id="mask"></div>
  <div class="modal">
    <div class="modal-content">
      <h3 id="alert_text" style="position:relative;margin:100px 10px;padding:10px;text-align: center;">CONTEXT_LAYER</h3>
      <button id="modalDismiss" class="btn" type="button">X</button>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous">
  </script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous">
  </script>
  <script>
    var status1 = new Array();
    $.get("https://api.thingspeak.com/channels/782080/feeds.json?api_key=LUYXWJ0CB6IZC9Q3&results=2", function (data) {
      var json = data;
      status1.push(parseInt(json.feeds[json.feeds.length - 1].field1))
      status1.push(parseInt(json.feeds[json.feeds.length - 1].field2))
      status1.push(parseInt(json.feeds[json.feeds.length - 1].field3))
    });

    function checking() {
      $.get("https://api.thingspeak.com/channels/782080/feeds.json?api_key=LUYXWJ0CB6IZC9Q3&results=2", function (
        data) {
        var json = data;
        for (var i = 0; i < 3; i++) {
          if (status1[i] == 0 && parseInt(eval('json.feeds[json.feeds.length - 1].field' + (i + 1)))) {
            switch (i) {
              case 0:
                $('#alert_text').html("조강림 환자 수액투여 완료");
                break;
              case 1:
                $('#alert_text').html("박지만 환자 수액투여 완료");
                break;
              case 2:
                $('#alert_text').html("김재우 환자 수액투여 완료");
                break;
            }
            $('.modal').fadeIn("slow");
            $('.modal-content').css({
              'margin-left': function () { //Horizontal centering
                return -($(this).width() / 2);
              }
            });
            wrapWindowByMask();
          }
        }
        status1[0] = parseInt(json.feeds[json.feeds.length - 1].field1);
        status1[1] = parseInt(json.feeds[json.feeds.length - 1].field2);
        status1[2] = parseInt(json.feeds[json.feeds.length - 1].field3);

        for (var i = 0; i < 3; i++) {
          switch (status1[i]) {
            case 0:
              $(`#p${i}`).removeClass("btn-primary");
              $(`#p${i}`).addClass("btn-outline-info");
              $(`#p${i}`).html('수액 투여중');
              break;
            case 1:
              $(`#p${i}`).removeClass("btn-outline-info");
              $(`#p${i}`).addClass("btn-primary");
              $(`#p${i}`).html('수액 투여완료 / 조치 요망');
              break;
            case 2:
              $(`#p${i}`).removeClass("btn-outline-info");
              $(`#p${i}`).addClass("btn-primary");
              $(`#p${i}`).html('수액 투여완료 / 조치 완료');
              break;
          }
        }
      });
    }
    setInterval(checking, 1000);
    $("#p0").click(function () {
      $.get("https://api.thingspeak.com/update?api_key=9X82ZV4DJCV5TUT1&field1=2&field2=" + status1[1] +
        "&field3=" + status1[2]);
    });
    $("#p1").click(function () {
      $.get("https://api.thingspeak.com/update?api_key=9X82ZV4DJCV5TUT1&field1=" + status1[0] +
        "&field2=2&field3=" + status1[2]);
    });
    $("#p2").click(function () {
      $.get("https://api.thingspeak.com/update?api_key=9X82ZV4DJCV5TUT1&field1=" + status1[0] + "&field2=" +
        status1[1] + "&field3=2");
    });

    function wrapWindowByMask() {
      //화면의 높이와 너비를 구한다.
      var maskHeight = $(document).height();
      var maskWidth = $(window).width();

      //마스크의 높이와 너비를 화면 것으로 만들어 전체 화면을 채운다.
      $('#mask').css({
        'width': maskWidth,
        'height': maskHeight
      });

      //애니메이션 효과
      $('#mask').fadeIn("slow");
    }
    $(function () {
      $("#modalDismiss").click(function () {
        $('div.modal').fadeOut("slow");
        $('#mask').fadeOut("slow");
      });
      //검은 막을 눌렀을 때
      $('#mask').click(function () {
        $(this).fadeOut("slow");
        $('div.modal').fadeOut("slow");
      });
      $('#mask').one('touchstart', function () {
        $(this).unbind('click');
      });
    });
  </script>
</body>

</html>